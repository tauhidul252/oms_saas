{% extends 'base.html' %}

{% block title %}Order Detail{% endblock %}

{% block content %}
<h2>ğŸ“„ Order Detail: {{ order.order_id }}</h2>

<table border="1" cellpadding="8" cellspacing="0" width="100%" style="margin-bottom: 20px;">
    <tr>
        <th>Customer Name</th>
        <td>{{ order.customer.name }}</td>
    </tr>
    <tr>
        <th>Phone</th>
        <td>{{ order.customer.phone }}</td>
    </tr>
    <tr>
        <th>Address</th>
        <td>{{ order.customer.address }}</td>
    </tr>
    <tr>
        <th>Tracking Number</th>
        <td>{{ order.tracking_number|default:"N/A" }}</td>
    </tr>
    <tr>
        <th>Status</th>
        <td>{{ order.status }}</td>
    </tr>
    <tr>
        <th>Order Date</th>
        <td>{{ order.date|date:"d M Y H:i" }}</td>
    </tr>
</table>

<h3>ğŸ› Product Summary</h3>
<table border="1" cellpadding="8" cellspacing="0" width="100%">
    <thead>
        <tr>
            <th>Product</th>
            <th>Qty</th>
            <th>Unit Price</th>
            <th>Subtotal</th>
        </tr>
    </thead>
    <tbody>
        {% for item in order.items.all %}
        <tr>
            <td>{{ item.product_name }}</td>
            <td>{{ item.quantity }}</td>
            <td>à§³ {{ item.unit_price }}</td>
            <td>à§³ {{ item.total_price }}</td>
        </tr>
        {% endfor %}
        <tr>
            <td colspan="3" align="right"><b>Discount:</b></td>
            <td>à§³ {{ order.discount_amount }}</td>
        </tr>
        <tr>
            <td colspan="3" align="right"><b>Total:</b></td>
            <td><b>à§³ {{ order.grand_total }}</b></td>
        </tr>
    </tbody>
</table>

<br>

<!-- Role-based Action Buttons -->
<div style="margin-top: 20px;">
    {% if request.user.is_superuser or request.user.employee.role == 'Admin' or request.user.employee.role == 'Manager' %}
        <a href="{% url 'order_edit' order.order_id %}" class="btn btn-warning">âœï¸ Edit</a>
    {% endif %}

    {% if request.user.is_superuser or request.user.employee.role == 'Admin' %}
        <a href="{% url 'order_delete' order.order_id %}" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this order?')">ğŸ—‘ Delete</a>
    {% endif %}

    <a href="{% url 'order_list' %}" class="btn btn-secondary">â† Back to List</a>
</div>

{% endblock %}
